---
title: Online/Offline Registration
---

import { Tabs, TabItem } from '@astrojs/starlight/components';

## Register your account online

This section assumes that you have already [generated a participation key](FUTURELINK:generatePartKey) for the account you plan to mark online.

For an account to participate in consensus, the account needs to be registered online by creating, signing, and sending a key registration transaction with details of the participation key that will vote on the account's behalf. Once the transaction is processed by the blockchain, the Verifiable Random Function public key (referred to as the VRF public key) is written into the accountâ€™s data, and the account will start participating in consensus with that key. This VRF public key is how the account is associated with the specific participation keys on the node.

The moment a key registration transaction is confirmed by the network, the change takes `320 rounds` to take effect. In other words, if a key registration is confirmed in `round 1000`, the account will not start participating until `round 1320`.

### Create an online key registration transaction

There are three main ways you can create an online key registration transaction.

<Tabs>
 <TabItem label="TUI">
 </TabItem>
 <TabItem label="LORA">
 </TabItem>
 <TabItem label="goal">
    Run the following code to create an online key registration transaction and dump the transaction object into the `online.txn` file. Make sure to replace `--address` to the account address sending the key registration transaction Also replace the `--firstvalid` to the most recent block round and `--lastvalid` to `latest block round + 1000`. You can get the latest block round by running `goal node status`.

    ```shell showLineNumbers=false frame=terminal
    # WARNING: This command must be run on the node where the partkey lives and the node
    # must only have a single partkey for the account. Otherwise the command will
    # choose one at random.
    $ goal account changeonlinestatus --address=[your account address] --fee=1000 --firstvalid=40000000 --lastvalid=40001000 --online=true --txfile=online.txn
    ```

    Now you should see the `online.txn` file created in your directory. You can inspect the transaction object inside of `online.txn` file by running `goal clerk inspect online.txn` and it should look something like this:

    ```shell showLineNumbers=false frame=terminal
    {
        "txn": {
            "fee": 1000,
            "fv": 40000000,
            "gh": "wGHE2Pwdvd7S...esN73ktiC1qzkkit8=",
            "lv": 40001000,
            "selkey": "KTBz/Hlw6Y4YkO2...EHj7i6cfqGgAmFvTZNA=",
            "snd": "J3JPZTQ5NSW3TARRC2QIYP...GNXXKODLZ27TLUWOTNWYKJYTRM",
            "sprfkey": "lr4HxC5NFQdXkcLVrlxp2iUWdz1e...afL5W04I050TWkx165kFsYl1A==",
            "type": "keyreg",
            "votefst": 40000000,
            "votekd": 1733,
            "votekey": "BdkCLcHQy4FvR...vVZhm51bjMiWXQmA=",
            "votelst": 70000000
        }
    }
    ```

 </TabItem>
</Tabs>

### Authorize and send the key registration transaction

<Tabs>
    <TabItem label="TUI">
    </TabItem>
    <TabItem label="LORA">
    </TabItem>
    <TabItem label="goal">
        To sign the key registration transaction inside the `online.txn` file generated from the previous step with goal, you first need to have a funded account in a goal wallet.

        ```shell showLineNumbers=false frame=terminal
        # First create a goal wallet. Make sure to securely store the seedphrase!
        goal wallet new [name of your wallet]

        # Import the account you used as the sender of the key registration transaction
        goal account import -m [your account MNEMONIC]

        # Or create an account inside the created wallet. After creation, fund the account with enough ALGO to cover the key registration transaction fee
        goal account new

        # Check that your account was successfully created
        goal account list
        ```

        After creating a goal account, you can sign the key registration transaction inside the `online.txn` file with the following command.

        If you are signing with the same account as the sender of the key registration transaction:

        ```shell showLineNumbers=false frame=terminal
        goal clerk sign -i online.txn -o signed-online.txn
        ```

        If you are signing with an account different from the key registration transaction sender:

        ```shell showLineNumbers=false frame=terminal
        goal clerk sign -i online.txn -o signed-online.txn -S [address of the signer]
        ```

        Now if you run `goal clerk inspect signed-online.txn`, you should see the signature added to the transaction object:

        ```shell showLineNumbers=false frame=terminal
        # You will only see `sgnr` if you signed the transaction with an account different from the sender.

        {
            "sgnr": "ITBCBZO4RMEOTRLT7HC...Y6O4KCV6UM36X2XSJOBPRKYM4",
            "sig": "eccBB5Yq2z16zsEUcmggS4...buYNMFHz7UlZnBsStgTrBNc8yl99DQ==",
            "txn": {
                "fee": 1000,
                "fv": 40000000,
                "gh": "wGHE2Pwdvd7S...esN73ktiC1qzkkit8=",
                "lv": 40001000,
                "selkey": "KTBz/Hlw6Y4YkO2...EHj7i6cfqGgAmFvTZNA=",
                "snd": "J3JPZTQ5NSW3TARRC2QIYP...GNXXKODLZ27TLUWOTNWYKJYTRM",
                "sprfkey": "lr4HxC5NFQdXkcLVrlxp2iUWdz1e...afL5W04I050TWkx165kFsYl1A==",
                "type": "keyreg",
                "votefst": 40000000,
                "votekd": 1733,
                "votekey": "BdkCLcHQy4FvR...vVZhm51bjMiWXQmA=",
                "votelst": 70000000
            }
        }
        ```

        Verify that the participation key is on the node prior to submitting the signed transaction. Once verified, wait for the network to reach the transaction's first valid round, then submit the transaction.

        ```shell showLineNumbers=false frame=terminal
        goal clerk rawsend -f signed-online.txn
        ```
    </TabItem>

</Tabs>

## Register your account offline

To mark an account offline send a key registration transaction to the network authorized by the account to be marked offline. The signal to mark the sending account offline is the issuance of a `"type": "keyreg"` transaction that does not contain any participation key-related fields (i.e. they are all set to null values)

Just like with online keyreg transactions. The moment a key registration transaction is confirmed by the network it takes `320 rounds` for the change to take effect. So, if a key registration is confirmed in `round 5000`, the account will stop participating at `round 5320`.

### Create an offline key registration transaction

There are three main ways you can create an online key registration transaction.

<Tabs>
    <TabItem label="TUI">
    </TabItem>
    <TabItem label="LORA">
    </TabItem>
    <TabItem label="goal">
        Run the following code to create an offline key registration transaction and dump the transaction object into the `offline.txn` file. Make sure to replace `--address` to the account address sending the key registration transaction Also replace the `--firstvalid` to the most recent block round and `--lastvalid` to `latest block round + 1000`. You can get the latest block round by running `goal node status`.

        ```shell showLineNumbers=false frame=terminal
        $ goal account changeonlinestatus --address=[your account address] --fee=1000 --firstvalid=50000000 --lastvalid=50001000 --online=false --txfile=offline.txn
        ```

        Now you should see the `offline.txn` file created in your directory. You can inspect the transaction object inside of `offline.txn` file by running `goal clerk inspect offline.txn` and it should look something like this:

        ```shell showLineNumbers=false frame=terminal
        {
            "txn": {
                "fee": 1000,
                "fv": 50000000,
                "gh": "wGHE2Pwdvd7S12BL...GYesN73ktiC1qzkkit8=",
                "lv": 50001000,
                "snd": "J3JPZTQ5NSW3TARRC2QIYP...XKODLZ27TLUWOTNWYKJYTRM",
                "type": "keyreg"
            }
        }
        ```
    </TabItem>

</Tabs>

### Authorize and send the key registration transaction

<Tabs>
    <TabItem label="TUI">
    </TabItem>
    <TabItem label="LORA">
    </TabItem>
    <TabItem label="goal">
        Sign the key registration transaction inside the `offline.txn` file with the following command.

        If you are signing with the same account as the sender of the key registration transaction:

        ```shell showLineNumbers=false frame=terminal
        goal clerk sign -i offline.txn -o signed-offline.txn
        ```

        If you are signing with an account different from the key registration transaction sender:

        ```shell showLineNumbers=false frame=terminal
        goal clerk sign -i offline.txn -o signed-offline.txn -S [address of the signer]
        ```

        Now if you run `goal clerk inspect signed-offline.txn`, you should see the signature added to the transaction object:

        ```shell showLineNumbers=false frame=terminal
        # You will only see `sgnr` if you signed the transaction with an account different from the sender.

        {
            "sgnr": "ITBCBZO4RMEOTRLT7HCA5HXUWUUMRAMDXY6O4KCV6UM36X2XSJOBPRKYM4",
            "sig": "tKrXVjXEE+B198qLoFVl5gzvaDaenwQOwCmUWYjTeA0OQbstPsn2OUfnjcbS8PJ5XneRbNbBK/hcsAlyoBBDDg==",
            "txn": {
                "fee": 1000,
                "fv": 50000000,
                "gh": "wGHE2Pwdvd7S12BL5FaOP20EGYesN73ktiC1qzkkit8=",
                "lv": 50001000,
                "snd": "J3JPZTQ5NSW3TARRC2QIYPGNWNH6NEYGGNXXKODLZ27TLUWOTNWYKJYTRM",
                "type": "keyreg"
            }
        }
        ```

        Once the transaction is signed, wait for the network to reach the transaction's first valid round and then submit the transaction.

        ```shell showLineNumbers=false frame=terminal
        goal clerk rawsend -f signed-offline.txn
        ```
    </TabItem>

</Tabs>
